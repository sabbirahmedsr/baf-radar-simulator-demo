<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>BAF RADAR SIMULATOR</title>
  <link rel="stylesheet" href="css/style.css">
</head>
<body>
  <header id="main-header">
    <h1>BAF RADAR SIMULATOR</h1>
    <nav>
      <a href="#simulator" class="nav-link active" data-view="simulator-view">Simulator</a>
      <a href="#planning" class="nav-link" data-view="planning-view">Project Planning</a>
      <a href="#inspiration" class="nav-link" data-view="inspiration-view">Inspiration</a>
      <a href="#asset" class="nav-link" data-view="asset-view">Asset</a>
    </nav>
  </header>

  <main>
    <div id="simulator-view" class="view active">
      <div id="top">
        <canvas id="altitudeGraphVerticalCanvas" width="120" height="800"></canvas>
        <div id="radarContainer">
          <canvas id="radarCanvas" width="800" height="800"></canvas>
        </div>
        <div id="sidePanel">
          <h3>Selected Target</h3>
          <div id="dataPanel" class="dataBlock">No selection</div>
          <div id="guiCommandPanel">
            <h4>Issue Command</h4>
            <div class="gui-command-row">
              <label for="guiCmdHeading">Heading (0-359)</label>
              <div class="input-group">
                <input type="number" id="guiCmdHeading" placeholder="e.g., 270">
                <button id="guiSendHeading">Set</button>
              </div>
            </div>
            <div class="gui-command-row">
              <label for="guiCmdAltitude">Altitude (ft)</label>
              <div class="input-group">
                <input type="number" id="guiCmdAltitude" placeholder="e.g., 9000" step="1000">
                <button id="guiSendAltitude">Set</button>
              </div>
            </div>
            <div class="gui-command-row">
              <label for="guiCmdSpeed">Speed (kts)</label>
              <div class="input-group">
                <input type="number" id="guiCmdSpeed" placeholder="e.g., 250">
                <button id="guiSendSpeed">Set</button>
              </div>
            </div>
            <div class="gui-command-row">
              <button id="guiSendHold">Engage Hold</button>
            </div>
          </div>
          <h3 class="collapsible-header active">Controls</h3>
          <div class="collapsible-content">
            <div class="control-group">
              <h4>Aircraft</h4>
              <button id="addAircraftBtn">Add Aircraft</button>
              <button id="addVGHSAircraftBtn">Add Hypersonic</button>
              <button id="removeAircraftBtn">Remove Sel.</button>
            </div>
            <div class="control-group">
              <h4>Display & Radar</h4>
              <label>Range (km): <input id="radarRangeInput" type="number" value="100" min="50" max="500"></label>
              <label><input id="toggleID" type="checkbox" checked> Show ID</label>
              <label><input id="toggleSpeed" type="checkbox" checked> Show Speed</label>
              <label><input id="toggleAltitude" type="checkbox" checked> Show Altitude</label>
              <label><input id="toggleHeading" type="checkbox" checked> Show Heading</label>
              <label><input id="toggleTrails" type="checkbox" checked> Show Trails</label>
            </div>
          </div>
          <h3 class="collapsible-header">Command Help</h3>
          <div class="collapsible-content">
            <div class="control-group">
              <p class="help-desc">Commands are in the format: <br><span class="help-command">&lt;Callsign&gt; &lt;Verb&gt; &lt;Param&gt;</span></p>
              <p><span class="help-command">C &lt;heading&gt;</span><br><span class="help-desc">Clearance to a 3-digit heading. Ex: <span class="help-command">C 090</span></span></p>
              <p><span class="help-command">C &lt;altitude&gt;</span><br><span class="help-desc">Clearance to an altitude (x1000 ft). Ex: <span class="help-command">C 12</span> (for 12,000 ft)</span></p>
              <p><span class="help-command">S &lt;speed&gt;</span><br><span class="help-desc">Set speed in knots. Ex: <span class="help-command">S 250</span></span></p>
              <p><span class="help-command">H</span><br><span class="help-desc">Hold current position.</span></p>
              <hr>
              <p class="help-desc">Commands can be chained:</p>
              <p><span class="help-command">AC101 C 270 C 8 S 210</span></p>
            </div>
          </div>
          <h3>Command Line</h3>
          <div id="cmdLine">
            <input id="cmdInput" placeholder="e.g. AC101 C 090 C 15 S 300" />
            <button id="cmdSend">Send</button>
          </div>
          <h3>Metrics</h3>
          <div id="metricsPanel" class="dataBlock">
            <div>Near-misses: <span id="metricNearMiss">0</span></div>
            <div>Conflicts resolved: <span id="metricResolved">0</span></div>
            <div>Commands issued: <span id="metricCommands">0</span></div>
          </div>
          <h3>Log</h3>
          <div id="logPanel"></div>
          <h3>Aircraft List</h3>
          <div id="aircraftList"></div>
        </div>
      </div>
    </div>

    <div id="planning-view" class="view"></div>
  </main>

    <div id="asset-view" class="view"></div>

    <div id="inspiration-view" class="view"></div>

  <script type="module" src="js/main.js"></script>
  <script>
    // Simple SPA router
    document.addEventListener('DOMContentLoaded', () => {
      const navLinks = document.querySelectorAll('.nav-link');
      const views = document.querySelectorAll('.view');

      const loadView = async (viewId) => {
        const viewElement = document.getElementById(viewId);
        // Only fetch content if the view is empty
        if (viewElement && viewElement.innerHTML.trim() === '') {
          try {
            const response = await fetch(`views/${viewId}.html`);
            if (!response.ok) throw new Error(`Could not load ${viewId}.html`);
            const content = await response.text();
            viewElement.innerHTML = content;
          } catch (error) {
            console.error('Failed to load view:', error);
            viewElement.innerHTML = `<p style="color: red;">Error loading content.</p>`;
          }
        }
      };

      navLinks.forEach(link => {
        link.addEventListener('click', (e) => {
          e.preventDefault();
          const targetViewId = link.getAttribute('data-view');

          loadView(targetViewId).then(() => {
            views.forEach(view => view.classList.remove('active'));
            navLinks.forEach(navLink => navLink.classList.remove('active'));
            link.classList.add('active');
            document.getElementById(targetViewId).classList.add('active');
            window.history.pushState({}, '', link.href);
          });
        });
      });

      // Pre-load the active view if it's not the simulator
      const activeLink = document.querySelector('.nav-link.active');
      if (activeLink) {
        const activeViewId = activeLink.getAttribute('data-view');
        if (activeViewId !== 'simulator-view') {
          loadView(activeViewId);
        }
      }
    });
  </script>
</body>
</html>
          document.getElementById(targetViewId).classList.add('active');
          link.classList.add('active');
          window.history.pushState({}, '', link.href);
        });
      });

    });
  </script>
</body>
</html>
